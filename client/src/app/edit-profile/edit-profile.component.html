<form #profileForm="ngForm" class="container py-5" (ngSubmit)="updateUserProfile(editUserProfile)">
  <!-- Cover Photo with Profile Picture Overlay -->
  <div class="position-relative mb-5">
    <!-- Cover Photo -->
    <img [src]="coverPreview || (baseUrl + editUserProfile.coverPhotoUrl)" alt="Cover Photo"
      class="img-fluid w-100 rounded shadow-sm" style="height: 220px; object-fit: cover;">

    <!-- Change Cover Button -->
    <div class="position-absolute bottom-0 end-0 p-3">
      <label class="btn btn-light btn-sm shadow-sm" title="Change Cover">
        <i class="bi bi-camera me-1"></i> Change Cover
        <input type="file" (change)="onCoverPhotoChange($event)" accept="image/*" hidden>
      </label>
    </div>

    <!-- Profile Picture - Centered on Bottom -->
    <div class="position-absolute start-50 translate-middle-x" style="bottom: -75px;">
      <div class="position-relative d-inline-block">
        <img [src]="profilePreview || (baseUrl + editUserProfile.profilePictureUrl)" alt="Profile Picture"
          class="rounded-circle border border-3 border-white shadow"
          style="width: 150px; height: 150px; object-fit: cover;">

        <!-- Change Profile Button -->
        <label class="btn btn-outline-secondary btn-sm position-absolute bottom-0 end-0 rounded-circle p-1"
          title="Change Profile Picture" style="transform: translate(20%, -20%);">
          <i class="bi bi-camera"></i>
          <input type="file" (change)="onProfilePhotoChange($event)" accept="image/*" hidden>
        </label>
      </div>
    </div>
  </div>

  <!-- Spacer to avoid layout overlap with profile picture -->
  <div class="mb-5"></div>


  <!-- Profile Picture -->
  <div class="row gy-4">
    <!-- Left: Basic Info -->
    <div class="col-md-4">
      <div class="form-floating mb-3">
        <input type="text" class="form-control" id="displayName" [(ngModel)]="editUserProfile.displayName"
          name="displayName" placeholder="Display Name">
        <label for="displayName">Display Name</label>
      </div>

      <div class="form-floating mb-3">
        <input type="text" class="form-control" id="userName" [(ngModel)]="editUserProfile.userName" name="userName"
          placeholder="Username">
        <label for="userName">Username</label>
      </div>

      <div class="form-floating mb-3">
        <input type="email" class="form-control" id="email" [(ngModel)]="editUserProfile.email" name="email"
          placeholder="Email">
        <label for="email">Email</label>
      </div>

      <div class="form-floating mb-3">
        <input type="text" class="form-control" id="phoneNumber" [(ngModel)]="editUserProfile.phoneNumber"
          name="phoneNumber" placeholder="Phone Number">
        <label for="phoneNumber">Phone Number</label>
      </div>
    </div>

    <!-- Right: Bio and Address -->
    <div class="col-md-8">
      <div class="mb-3">
        <label class="form-label fw-semibold">Bio</label>
        <textarea class="form-control" rows="4" [(ngModel)]="editUserProfile.bio" name="bio"
          placeholder="Tell us about yourself..."></textarea>
      </div>

      <div class="row">
        <div class="col-md-6 mb-3">
          <label class="form-label fw-semibold">Date of Birth</label>
          <input type="date" class="form-control" [(ngModel)]="editUserProfile.dateOfBirth" name="dateOfBirth">
        </div>
        <div class="col-md-6 mb-3">
          <label class="form-label fw-semibold">Gender</label>
          <select class="form-select" [(ngModel)]="editUserProfile.gender" name="gender">
            <option [ngValue]="0">Male</option>
            <option [ngValue]="1">Female</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div class="col-md-4 mb-3">
          <label class="form-label fw-semibold">Country</label>
          <input type="text" class="form-control" [(ngModel)]="editUserProfile.userAddress.country" name="country">
        </div>
        <div class="col-md-4 mb-3">
          <label class="form-label fw-semibold">City</label>
          <input type="text" class="form-control" [(ngModel)]="editUserProfile.userAddress.city" name="city">
        </div>
        <div class="col-md-4 mb-3">
          <label class="form-label fw-semibold">Street</label>
          <input type="text" class="form-control" [(ngModel)]="editUserProfile.userAddress.street" name="street">
        </div>
      </div>
    </div>
  </div>

  <!-- Submit Button -->
  <div class="text-end mt-4">
    <button type="submit" class="btn btn-primary px-4">
      <i class="bi bi-save me-1"></i> Save Changes
    </button>
  </div>
</form>